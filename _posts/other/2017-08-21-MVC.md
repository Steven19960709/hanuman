---
layout: post
title: 前端进阶知识（54）———— MVC 模式
date: 2017-08-21
tags: [mvc]
---

今天来介绍一下MVC模式

## MVC 

MVC全名是Model View Controller，是模型（model）- 视图（view）-控制器（controller）的缩写，MVC 是一种使用 MVC（Model View Controller 模型-视图-控制器）设计创建 Web 应用程序的模式，是一种软件设计典范，指的是用一种业务逻辑，数据，界面分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进个性化定制界面以及用户交互的同时，不需要重新编写业务逻辑。MVC被独特的发展起来用于映射传统的输入，处理和输出功能在一个逻辑的图形化用户界面的结构中。

### 模型 Model

模型代表了业务数据和业务逻辑； 当数据发生改变时，它要负责通知控制器调用视图部分；多个模型能为多个视图提供数据。由于同一个模型可以被多个视图重用，所以提高了应用的可重用性。 Model（模型）是应用程序中用于处理应用程序数据逻辑的部分。通常模型对象负责在数据库中存取数据。


### 视图 （view）

视图向用户显示相关的数据，并能接收用户的输入数据，但是它并不进行任何实际的业务处理。通常是一句模型数据创建的。

### 控制器 （controller）

它通过View来接受用户的输入，之后利用Model来处理用户的数据，最后把结果返回给View。Controll就是View和Model之间的一个协调者。是应用程序中处理用户交互的部分。

<img src="http://outu8mec9.bkt.clouddn.com/mvc.PNG">

下面举个例子：单击Web页面中的超链接和发送HTML表单时：

1、视图将超链接和表单发送给控制器

2、控制器接收请求并决定调用哪个模型构件去处理请求。控制器本身不输出任何东西和做任何处理。

3、模型开始分析处理数据。经过模型处理后返回数据给控制器。

4、然后再由控制器确定用哪个视图来显示返回的数据。

### 优缺点 

#### 优点

1.耦合性地；视图层和业务层分离，这样就允许更改视图层代码而不用重新编译模型和控制器代码，同样，一个应用的业务流程或者业务规则的改变只需要改动MVC的模型层即可。

2.重用性高；。MVC模式允许使用各种不同样式的视图来访问同一个服务器端的代码，因为多个视图能共享一个模型，它包括任何WEB（HTTP）浏览器或者无线浏览器（wap），比如，用户可以通过电脑也可通过手机来订购某样产品，虽然订购的方式不一样，但处理订购产品的方式是一样的。

3.生命周期成本低；MVC使开发和维和用户接口的技术含量降低。

4.部署快，利于软件工程化管理。

5.可维护性高，分离视图层和业务逻辑层也是的web应用更易于维护和修改。

#### 缺点

1.定义不明确，使用MVC需要精心计划，内部原理复杂，很耗时间。模型和视图严格分离，给调试应用程序带来困难。每个构件都需要彻底测试。

2.不适合中小型应用程序，研究MVC的时间，对于中小型应用程序，得不偿失。

3.增加了系统的结构和实现的复杂性。对于简单的界面，严格遵循MVC，使模型、视图与控制器分离，会增加结构的复杂性，并可能产生过多的更新操作，降低运行效率。

4.试图对模型数据的低效率访问。依据模型操作接口的不同，视图可能需要多次调用才能获得足够的显示数据。对未变化数据的不必要的频繁访问，也将损害操作性能。

## 涉及到H5技术

一、Local storage & Session storage  键值对存储数据  经常改的就需要用这个

二、Application Cache  本地缓存应用所需的文件 如果基本不改变就用这个

三、Web SQL 关系数据库

### web存储 

web存储在之前的HTML5中的客户端存储中介绍过了。这里简单提一下。

1.localStorage方法，没有时间限制。

2.sessionStorage方法，针对一个session的数据存储。临时的存储的，当窗口关闭就会删除。

操作方式：

	localStorage.firstname="Sun";
	document.write(localStorage.lastname);

	sessionStorage.lastname="Smith";
	document.write(sessionStorage.lastname);

### Application Cache

HTML5引入了应用程序缓存技术，意味着web应用可进行缓存，并在没有网络的情况下使用，通过创建cache manifest文件，可以轻松的创建离线应用。

Application Cache的尺寸限制统一在5M。

#### 应用程序缓存优势

离线浏览 - 用户可在应用离线时使用它们；速度 - 已缓存资源加载得更快；减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。

#### 使用方法

如果我们需要在页面中使用Cache缓存的话，需要在html标签中加一个属性。

	<html manifest="demo.cache"></html>//规定文档的缓存 manifest 的位置

其中Manifest分为三部分：

1、CACHE MANIFEST - 在首次下载后进行缓存

2、NETWORK - 需要与服务器连接，且不会被缓存

3、FALLBACK - 当页面无法访问时的回退页面（比如 404 页面）

这个时候，服务器端需要维护一个manifest清单，我们利用PHP来举例子：

	<?php
	header('Content-Type: text/cache-manifest')
	?>
	CACHE MANIFEST
	# 2017-04-23 v1.0.0 //版本号，小版本更新，低位改变，大版本更新高位改变。一旦改变，清单所有都要变。
	./source/jquery.min.js //需要缓存的文件
	
	NETWORK:
	*
	
通常我们使用缓存的对象是很少发生改变的，或者更新频率比较低的文件，例如jquery之类的。如果是经常发生改变的，例如图片。

#### 配置正确的MIME-type

MIME类型就是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。

manifest 文件需要配置正确的 MIME-type，即 "text/cache-manifest"。必须在 web 服务器上进行配置，不同的服务器不一样。

### WEB	SQL

Web Sql Database，中文翻译作“本地数据库”，是随着HTML5规范加入的在浏览器端运行的轻量级数据库。在这其中，一项非常重要的功能就是数据库的本地存储功能。在HTML5中内置了一个可以通过SQL语言来访问的数据库。在HTML4中，数据库只能放在服务器端，只能通过服务器来访问数据库，但是在HTML5中，可以就像访问本地文件那样轻松的对内置的数据库进行直接访问。本地数据库通过Javascript脚本来进行对数据库的操作.

1.openDatabase：使用现有数据库或新建数据库来创建数据库对象。

	openDatabase("APP","1.0","Not the FT Web App",(5 * 1024 * 1024));

	参数：
	1、数据库名称
	2、数据库版本号
	3、对数据库的描述
	4、数据库存储大小
	5、回调函数（可选）


transaction：这个方法允许我们根据情况控制事务提交或回滚

	smallDatabase.transaction(querysql,errorCallback,successCallback);
	参数：
	1、包含事务内容的一个方法
	（querysql中的任何一句sql语句出错，都会回滚）
	2、执行成功回调函数（可选）
	3、回调函数（可选）


executeSql：用于执行SQL 查询

	tx.executeSql(query, data[ ], innerSuccessCallback, errorCallback);
	1、表示查询的字符串，使用的SQL语言是SQLite 3.6.19。（必选）
	2、插入到查询中问号所在处的字符串数据。（可选）
	3、成功时执行的回调函数。返回两个参数：tx和执行的结果（可选）
	4、一个失败时执行的回调函数。（可选）

那么关于这部分内容就讲到这里。希望大家能有所收获。





